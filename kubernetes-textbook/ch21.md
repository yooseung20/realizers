# 21장 쿠버네티스에서 서버리스 펑션 실행하기

## 21.1 서버리스 플랫폼의 동작 원리

* 서버리스 플랫폼(Serverless platform)이란?
    * 애플리케이션의 배포와 운영에서 서버의 관리와 유지보수 부담을 제거하고, 개발자가 코드만 작성하면 자동으로 서버 리소스가 관리되는 환경을 제공하는 클라우드 컴퓨팅 모델
    * “서버리스”라는 용어는 실제로 서버가 없다는 의미가 아니라, 서버의 관리와 운영을 클라우드 서비스 제공자가 대신 처리한다는 의미
    * 사용자는 애플리케이션을 실행하기 위한 서버 인프라에 대한 직접적인 신경을 쓰지 않아도 됨
* 클라우드 시장에는 이미 많은 수의 서버리스 플랫폼이 나와 있음
* 하지만 이들은 대부분 클라우드 프로바이더와 밀접하게 결합되어 있음
    * AWS 람다에서 구동하던 컴포넌트를 애저 펑션으로 이주하는 것은 그리 쉽지 않음
* 쿠버네티스 생태계에는 이미 몇 가지 서버리스 플랫폼이 존재함
* 플랫폼별로 접근법이 다른데, 그중 가장 널리 쓰이는 것은 구글에서 개발한 Knative 프로젝트
* Kubeless는 2021-12-16에 프로젝트 유지보수가 중단되었음

[그림 21-1]()

* 펑션 = 파드
* HTTP 트리거 = 인그레스 규칙
* 일정 트리거 = 크론잡


## 21.2 HTTP 요청을 통해 서버리스 펑션 호출하기

* 펑션마다 다른 경로를 부여하는 방식으로 API 전체를 서버리스 펑션으로 만들 수 있음
* 하지만 API 규모가 크다면 컴퓨팅 자원을 소모하는 파드 수도 그만큼 늘어남
* 파드의 리소스 요청량이나 제한량에는 기본값이 없기 때문에 API를 단일 파드로 실행하는 것에 비해 노드가 메모리 고갈 상태에 빠질 가능성이 높음
* 펑션 하나하나가 각기 언어 런타임을 읽어 들이느라 메모리를 소모하기 때문에 서버리스 펑션을 많이 사용하면 파드 축출이 일어나기 쉬움

## 21.3 서버리스 펑션 호출하기: 이벤트 트리거와 스케줄 트리거

* 펑션이 배치될 때 바로 적용되는 기본 트리거는 없음

## 21.4 Serverless를 이용하여 서버리스 펑션 추상화하기

* Serverless는 서버리스 펑션의 정의를 표준화하고 이를 실제 동작을 맡는 다른 서버리스 플랫폼에 통합하는 기능을 제공하는 프로젝트
    * Serverless 스타일로 정의한 펑션을 Kubeless에서 구동시킬 수 있음
    * Kubeless를 떠나 Serverless가 지원하는 다른 서버리스 플랫폼으로 이주할 때 작업을 최소화 할 수 있음
    * Serverless는 AWS 람다와 애저 펑션의 추상화 계층으로도 쓸 수 있음

## 21.5 서버리스 펑션의 용도 이해하기

* 예를 들어 애플리케이션은 쿠버네티스로 구동되어 있고 서버리스 함수는 AWS Lambda로 구현되어 있어 애플리케이션과 서버리스 컴포넌트가 전혀 다른 환경일 때 큰 단점이 생김
* 배치 파이프라인 구성, 모니터링 도구, 문재 해결 워크플로우 등이 달라 질 수 있음
* 쿠버네티스에서 동작하는 서버리스 플랫폼은 이를 통합해서 관리할 수 있는 장점이 있음
* 하지만 클라우드 기반 서버리스 플랫폼에서 제안하는 운영 업무 제로 효과도 없고, 클러스터의 컴퓨팅 리소스를 공유하는 만큼 스케일링이 자유롭지도 않음
* 어떤 플랫폼을 써야할 지는 각자가 처한 환경에 따라 달라질 수 있음
